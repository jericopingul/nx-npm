const a7_0x894a=['Status\x20update','run','log','../../api/error-reporter.api','error','encryptionKey','defineProperty','nodes','../../../utilities/serializer-overrides','See\x20run\x20details\x20at\x20','status','../../../utilities/metric-logger','next','retrieve','note','/nx.json','toString','then','Found\x20unknown\x20task:\x20','criticalErrorMessage','number\x20of\x20completed\x20tasks:\x20','ErrorReporterApi','../../../utilities/create-no-new-messages-timeout','Unable\x20to\x20complete\x20a\x20run.','getRunGroup','printRunGroupError','error:\x20','readFileSync','ENCRYPTION_KEY','cacheDirectory','taskId','dependencies','taskGraph','write','message','Extracting\x20artifacts','createStartRequest','Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','VERBOSE_LOGGING','startTask','Command\x20execution\x20failed.','FileStorage','target','__awaiter','projectGraph','COMPLETED','hash','../../file-storage/file-storage','commandStatus','runUrl','get','apply','./split-task-graph-into-stages','value','values','copyFilesFromCache','find','scheduleTask','logCommand','nxCloudDistributedTasksRunner','Waiting...','configuration','done','executionStatus','Error:','DistributedExecutionApi','../../../utilities/nx-imports','project','lifeCycle','Starting\x20distributed\x20command\x20execution','success','throw','strip-json-comments','strictlyOrderedTargets','join','stdout','../../error/print-run-group-error','__esModule','axiosException','addVerticalSeparator','assign','Successfully\x20completed\x20running\x20the\x20command.','E2EEncryption','../../file-storage/e2e-encryption','../../../utilities/environment','url','length','./distributed-execution.api','parse','createNoNewMessagesTimeout','exit','build','completedTasks','splitTasksIntoStages'];(function(_0x124774,_0x894ad3){const _0x4a7eca=function(_0x418cda){while(--_0x418cda){_0x124774['push'](_0x124774['shift']());}};_0x4a7eca(++_0x894ad3);}(a7_0x894a,0xb0));const a7_0x4a7e=function(_0x124774,_0x894ad3){_0x124774=_0x124774-0x0;let _0x4a7eca=a7_0x894a[_0x124774];return _0x4a7eca;};'use strict';var __awaiter=this&&this[a7_0x4a7e('0x37')]||function(_0x1aedc3,_0x2609af,_0x3ddd8d,_0x4102bc){function _0x7d216a(_0x5589bc){return _0x5589bc instanceof _0x3ddd8d?_0x5589bc:new _0x3ddd8d(function(_0x1cb836){_0x1cb836(_0x5589bc);});}return new(_0x3ddd8d||(_0x3ddd8d=Promise))(function(_0x42d1e0,_0x1bde00){function _0x4915bc(_0x341487){try{_0x26e7c8(_0x4102bc[a7_0x4a7e('0x18')](_0x341487));}catch(_0x594a83){_0x1bde00(_0x594a83);}}function _0x5e9843(_0x47d202){try{_0x26e7c8(_0x4102bc[a7_0x4a7e('0x53')](_0x47d202));}catch(_0x4dd90b){_0x1bde00(_0x4dd90b);}}function _0x26e7c8(_0x3fdcbc){_0x3fdcbc[a7_0x4a7e('0x4a')]?_0x42d1e0(_0x3fdcbc[a7_0x4a7e('0x41')]):_0x7d216a(_0x3fdcbc[a7_0x4a7e('0x41')])[a7_0x4a7e('0x1d')](_0x4915bc,_0x5e9843);}_0x26e7c8((_0x4102bc=_0x4102bc[a7_0x4a7e('0x3f')](_0x1aedc3,_0x2609af||[]))['next']());});};Object[a7_0x4a7e('0x12')](exports,a7_0x4a7e('0x59'),{'value':!![]});exports[a7_0x4a7e('0x47')]=void 0x0;const stripJsonComments=require(a7_0x4a7e('0x54'));const fs_1=require('fs');const distributed_execution_api_1=require(a7_0x4a7e('0x5'));const file_storage_1=require(a7_0x4a7e('0x3b'));const e2e_encryption_1=require(a7_0x4a7e('0x1'));const waiter_1=require('../../../utilities/waiter');const environment_1=require(a7_0x4a7e('0x2'));const print_run_group_error_1=require(a7_0x4a7e('0x58'));const create_no_new_messages_timeout_1=require(a7_0x4a7e('0x22'));const metric_logger_1=require(a7_0x4a7e('0x17'));const error_reporter_api_1=require(a7_0x4a7e('0xf'));const serializer_overrides_1=require(a7_0x4a7e('0x14'));const task_graph_creator_1=require('./task-graph-creator');const split_task_graph_into_stages_1=require(a7_0x4a7e('0x40'));const {output,workspaceRoot,getOutputs,Cache}=require(a7_0x4a7e('0x4e'));class NoopLifeCycle{[a7_0x4a7e('0x45')](_0x413a19){}[a7_0x4a7e('0x33')](_0x233281){}['endTask'](_0x26a56f,_0x379fce){}}function runDistributedExecution(_0x56551f,_0x487645,_0x3e9909,_0x419ebe,_0xe8421d,_0x32ab0f,_0xf389f1){return __awaiter(this,void 0x0,void 0x0,function*(){const _0xaffafe=yield _0x56551f['start']((0x0,distributed_execution_api_1[a7_0x4a7e('0x30')])(_0x32ab0f,(0x0,split_task_graph_into_stages_1[a7_0x4a7e('0xb')])(_0xf389f1),_0x487645));return yield processTasks(_0x56551f,_0x419ebe,_0xe8421d,_0x487645,_0xaffafe,Object[a7_0x4a7e('0x42')](_0xf389f1['tasks']),_0x3e9909);});}function processTasks(_0x1208ad,_0x361234,_0x209a69,_0x19a4aa,_0x5bf42a,_0x16b419,_0x2c9f07){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x12dc5a={};const _0x3c40df=(0x0,create_no_new_messages_timeout_1[a7_0x4a7e('0x7')])();const _0x325a7d=new waiter_1['Waiter']();while(!![]){if(environment_1[a7_0x4a7e('0x32')]){output['note']({'title':a7_0x4a7e('0x48')});}yield _0x325a7d['wait']();const _0x2f1317=yield _0x1208ad[a7_0x4a7e('0x16')](_0x5bf42a);if(environment_1[a7_0x4a7e('0x32')]){output[a7_0x4a7e('0x1a')]({'title':a7_0x4a7e('0xc'),'bodyLines':['executionId:\x20'+_0x5bf42a,'executionStatus:\x20'+_0x2f1317[a7_0x4a7e('0x4b')],a7_0x4a7e('0x20')+_0x2f1317[a7_0x4a7e('0xa')][a7_0x4a7e('0x4')],a7_0x4a7e('0x26')+_0x2f1317[a7_0x4a7e('0x1f')]]});}if(_0x2f1317['criticalErrorMessage']){output['error']({'title':'Distributed\x20Execution\x20Terminated','bodyLines':[a7_0x4a7e('0x4c'),_0x2f1317[a7_0x4a7e('0x1f')]]});process['exit'](0x1);}_0x3c40df(_0x2f1317[a7_0x4a7e('0xa')]['length']);for(const _0x453894 of _0x2f1317[a7_0x4a7e('0xa')]){if(_0x12dc5a[_0x453894[a7_0x4a7e('0x2a')]])continue;yield processTask(_0x361234,_0x209a69,_0x2c9f07,_0x19a4aa,_0x16b419,_0x453894);_0x325a7d['reset']();_0x12dc5a[_0x453894[a7_0x4a7e('0x2a')]]=!![];}if(_0x2f1317[a7_0x4a7e('0x4b')]===a7_0x4a7e('0x39')){return{'commandStatus':_0x2f1317[a7_0x4a7e('0x3c')],'runUrl':_0x2f1317['runUrl']};}}});}function processTask(_0xad9317,_0x371256,_0x1a8041,_0x592540,_0x3eb5b8,_0x5155d4){return __awaiter(this,void 0x0,void 0x0,function*(){if(environment_1[a7_0x4a7e('0x32')]){output[a7_0x4a7e('0x1a')]({'title':'Processing\x20task\x20'+_0x5155d4[a7_0x4a7e('0x2a')]});}const _0x348ca9=_0x3eb5b8[a7_0x4a7e('0x44')](_0x2158e1=>_0x5155d4[a7_0x4a7e('0x2a')]===_0x2158e1['id']);if(!_0x348ca9){throw new Error(a7_0x4a7e('0x1e')+_0x5155d4[a7_0x4a7e('0x2a')]);}if(environment_1['VERBOSE_LOGGING']){output[a7_0x4a7e('0x1a')]({'title':'Retrieving\x20artifacts\x20from\x20'+_0x5155d4[a7_0x4a7e('0x3')]});}yield _0xad9317[a7_0x4a7e('0x19')](_0x5155d4[a7_0x4a7e('0x3a')],_0x5155d4[a7_0x4a7e('0x3')],_0x592540[a7_0x4a7e('0x29')]||'./node_modules/.cache/nx');const _0x12528c=yield _0x371256[a7_0x4a7e('0x3e')](Object[a7_0x4a7e('0x5c')](Object[a7_0x4a7e('0x5c')]({},_0x348ca9),{'hash':_0x5155d4[a7_0x4a7e('0x3a')]}));const _0x1e927c=getOutputs(_0x1a8041['projectGraph'][a7_0x4a7e('0x13')],_0x348ca9);if(environment_1[a7_0x4a7e('0x32')]){output[a7_0x4a7e('0x1a')]({'title':a7_0x4a7e('0x2f'),'bodyLines':_0x1e927c});}yield _0x371256[a7_0x4a7e('0x43')](_0x5155d4[a7_0x4a7e('0x3a')],_0x12528c,_0x1e927c);output[a7_0x4a7e('0x46')](getCommand(_0x348ca9));process[a7_0x4a7e('0x57')][a7_0x4a7e('0x2d')](_0x12528c['terminalOutput']);output[a7_0x4a7e('0x5b')]();});}function getCommand(_0x224e49){const _0x47c34d=_0x224e49[a7_0x4a7e('0x36')][a7_0x4a7e('0x49')]?':'+_0x224e49['target'][a7_0x4a7e('0x49')]:'';return['nx',a7_0x4a7e('0xd'),_0x224e49[a7_0x4a7e('0x36')][a7_0x4a7e('0x4f')]+':'+_0x224e49[a7_0x4a7e('0x36')]['target']+_0x47c34d,(0x0,serializer_overrides_1['serializeOverrides'])(_0x224e49)][a7_0x4a7e('0x56')]('\x20');}const nxCloudDistributedTasksRunner=(_0x311273,_0x1957e6,_0x4c97f5)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(environment_1[a7_0x4a7e('0x32')]){output['note']({'title':a7_0x4a7e('0x51')});}_0x1957e6[a7_0x4a7e('0x50')]=new NoopLifeCycle();const _0x5dfb14=(0x0,environment_1[a7_0x4a7e('0x24')])();if(!_0x5dfb14){(0x0,print_run_group_error_1[a7_0x4a7e('0x25')])();return process[a7_0x4a7e('0x8')](0x1);}const _0x430280=new e2e_encryption_1[(a7_0x4a7e('0x0'))](environment_1[a7_0x4a7e('0x28')]||_0x1957e6[a7_0x4a7e('0x11')]);const _0x2259d6=new error_reporter_api_1[(a7_0x4a7e('0x21'))](_0x1957e6);const _0x4a71a3=new file_storage_1[(a7_0x4a7e('0x35'))](_0x430280,_0x2259d6,!![]);const _0x5c5874=new Cache(_0x1957e6);const _0x4cc200=new distributed_execution_api_1[(a7_0x4a7e('0x4d'))](_0x1957e6);try{const _0x349e75=getTaskGraph(_0x4c97f5,_0x311273,_0x1957e6);const _0x2e1c97=yield runDistributedExecution(_0x4cc200,_0x1957e6,_0x4c97f5,_0x4a71a3,_0x5c5874,_0x5dfb14,_0x349e75);if(_0x2e1c97[a7_0x4a7e('0x3c')]===0x0){output[a7_0x4a7e('0x52')]({'title':a7_0x4a7e('0x5d'),'bodyLines':['See\x20run\x20details\x20at\x20'+_0x2e1c97['runUrl']]});}else{output[a7_0x4a7e('0x10')]({'title':a7_0x4a7e('0x34'),'bodyLines':[a7_0x4a7e('0x15')+_0x2e1c97[a7_0x4a7e('0x3d')]]});}yield(0x0,metric_logger_1['submitRunMetrics'])(_0x1957e6);process[a7_0x4a7e('0x8')](_0x2e1c97[a7_0x4a7e('0x3c')]);}catch(_0x32c37b){output[a7_0x4a7e('0x10')]({'title':a7_0x4a7e('0x23'),'bodyLines':[_0x32c37b[a7_0x4a7e('0x2e')]]});if(_0x32c37b[a7_0x4a7e('0x5a')]){console[a7_0x4a7e('0xe')](_0x32c37b[a7_0x4a7e('0x5a')]);}else{console['log'](_0x32c37b);}try{yield _0x4cc200['completeRunGroupWithError'](_0x5dfb14,a7_0x4a7e('0x31')+_0x32c37b[a7_0x4a7e('0x2e')]+'\x22');}finally{process['exit'](0x1);}}});exports[a7_0x4a7e('0x47')]=nxCloudDistributedTasksRunner;function getTaskGraph(_0x5a9075,_0xa6cdf5,_0x45dca8){if(_0x5a9075[a7_0x4a7e('0x2c')]){return _0x5a9075[a7_0x4a7e('0x2c')];}else{const _0xace5e3=JSON[a7_0x4a7e('0x6')](stripJsonComments((0x0,fs_1[a7_0x4a7e('0x27')])(workspaceRoot+a7_0x4a7e('0x1b'))[a7_0x4a7e('0x1c')]()));return new task_graph_creator_1['TaskGraphCreator'](_0x5a9075[a7_0x4a7e('0x38')],getDefaultDependencyConfigs(_0xace5e3,_0x45dca8))['createTaskGraph'](_0xa6cdf5);}}function getDefaultDependencyConfigs(_0x1c00b5,_0x1f7cb1){var _0x46a71c,_0x100ed4;const _0x386186=(_0x46a71c=_0x1c00b5['targetDependencies'])!==null&&_0x46a71c!==void 0x0?_0x46a71c:{};const _0x385694=_0x1f7cb1?(_0x100ed4=_0x1f7cb1[a7_0x4a7e('0x55')])!==null&&_0x100ed4!==void 0x0?_0x100ed4:[a7_0x4a7e('0x9')]:[];for(const _0x3edf0d of _0x385694){_0x386186[_0x3edf0d]=_0x386186[_0x3edf0d]||[];_0x386186[_0x3edf0d]['push']({'target':_0x3edf0d,'projects':a7_0x4a7e('0x2b')});}return _0x386186;}