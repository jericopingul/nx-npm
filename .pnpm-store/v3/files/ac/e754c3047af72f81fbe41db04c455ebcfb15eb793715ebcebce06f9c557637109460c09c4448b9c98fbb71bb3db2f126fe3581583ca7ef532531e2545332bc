const a6_0x15f5=['apply','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','__esModule','createApiAxiosInstance','status','enabled','__awaiter','dteStart','../../../utilities/axios','hash','map','../../../utilities/nx-imports','exit','../../../utilities/environment','defineProperty','parallel','post','data','then','message','target','RUNNER_FAILURE_PERF_ENTRY','/nx-cloud/executions/status','serializeOverrides','done','DistributedExecutionApi','axiosMultipleTries','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','createStartRequest','/nx-cloud/executions/start','next','false','response','error','../../../utilities/metric-logger','../../../utilities/serializer-overrides','axiosException','configuration','completeRunGroupWithError','createMetricRecorder','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','parseCommand','recordMetric','stopAgentsOnFailure','start','maxParallel','mapRespToPerfEntry','true','throw','apiAxiosInstance'];(function(_0x3e785f,_0x15f572){const _0x7e598f=function(_0x3c5a61){while(--_0x3c5a61){_0x3e785f['push'](_0x3e785f['shift']());}};_0x7e598f(++_0x15f572);}(a6_0x15f5,0x16a));const a6_0x7e59=function(_0x3e785f,_0x15f572){_0x3e785f=_0x3e785f-0x0;let _0x7e598f=a6_0x15f5[_0x3e785f];return _0x7e598f;};'use strict';var __awaiter=this&&this[a6_0x7e59('0x2c')]||function(_0x45d963,_0x5267e4,_0x20d024,_0x1d6ede){function _0x514ff4(_0x121f74){return _0x121f74 instanceof _0x20d024?_0x121f74:new _0x20d024(function(_0x1e9054){_0x1e9054(_0x121f74);});}return new(_0x20d024||(_0x20d024=Promise))(function(_0xdaab90,_0x53841c){function _0x15554f(_0x3328fd){try{_0xefcd37(_0x1d6ede[a6_0x7e59('0x12')](_0x3328fd));}catch(_0x5002fc){_0x53841c(_0x5002fc);}}function _0x526ade(_0x3ea0d3){try{_0xefcd37(_0x1d6ede[a6_0x7e59('0x24')](_0x3ea0d3));}catch(_0x192fd6){_0x53841c(_0x192fd6);}}function _0xefcd37(_0x32efec){_0x32efec[a6_0x7e59('0xc')]?_0xdaab90(_0x32efec['value']):_0x514ff4(_0x32efec['value'])[a6_0x7e59('0x6')](_0x15554f,_0x526ade);}_0xefcd37((_0x1d6ede=_0x1d6ede[a6_0x7e59('0x26')](_0x45d963,_0x5267e4||[]))[a6_0x7e59('0x12')]());});};Object[a6_0x7e59('0x2')](exports,a6_0x7e59('0x28'),{'value':!![]});exports[a6_0x7e59('0x10')]=exports[a6_0x7e59('0xd')]=void 0x0;const axios_1=require(a6_0x7e59('0x2e'));const environment_1=require(a6_0x7e59('0x1'));const metric_logger_1=require(a6_0x7e59('0x16'));const serializer_overrides_1=require(a6_0x7e59('0x17'));const {output,unparse}=require(a6_0x7e59('0x31'));class DistributedExecutionApi{constructor(_0x3a46fb){this['apiAxiosInstance']=(0x0,axios_1[a6_0x7e59('0x29')])(_0x3a46fb);}[a6_0x7e59('0x20')](_0xc329e5){var _0x4a5ea4;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x35b24f=(0x0,metric_logger_1[a6_0x7e59('0x1b')])(a6_0x7e59('0x2d'));let _0x358884;try{_0x358884=yield(0x0,axios_1[a6_0x7e59('0xe')])(()=>this['apiAxiosInstance'][a6_0x7e59('0x4')](a6_0x7e59('0x11'),_0xc329e5));_0x35b24f['recordMetric']((0x0,metric_logger_1[a6_0x7e59('0x22')])(_0x358884));}catch(_0x3ecbc0){_0x35b24f[a6_0x7e59('0x1e')](((_0x4a5ea4=_0x3ecbc0===null||_0x3ecbc0===void 0x0?void 0x0:_0x3ecbc0[a6_0x7e59('0x18')])===null||_0x4a5ea4===void 0x0?void 0x0:_0x4a5ea4[a6_0x7e59('0x14')])?(0x0,metric_logger_1[a6_0x7e59('0x22')])(_0x3ecbc0[a6_0x7e59('0x18')][a6_0x7e59('0x14')]):metric_logger_1[a6_0x7e59('0x9')]);throw _0x3ecbc0;}if(!_0x358884['data'][a6_0x7e59('0x2b')]){throw new Error(a6_0x7e59('0x27'));}if(_0x358884[a6_0x7e59('0x5')][a6_0x7e59('0x15')]){throw new Error(_0x358884['data']['error']);}return _0x358884[a6_0x7e59('0x5')]['id'];});}[a6_0x7e59('0x2a')](_0xb9c8c5){var _0x5c0e1e;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x8acd40=(0x0,metric_logger_1[a6_0x7e59('0x1b')])('dteStatus');try{const _0x18e0bf=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a6_0x7e59('0x25')][a6_0x7e59('0x4')](a6_0x7e59('0xa'),{'id':_0xb9c8c5}));_0x8acd40[a6_0x7e59('0x1e')]((0x0,metric_logger_1[a6_0x7e59('0x22')])(_0x18e0bf));return _0x18e0bf[a6_0x7e59('0x5')];}catch(_0x331b4f){_0x8acd40[a6_0x7e59('0x1e')](((_0x5c0e1e=_0x331b4f===null||_0x331b4f===void 0x0?void 0x0:_0x331b4f[a6_0x7e59('0x18')])===null||_0x5c0e1e===void 0x0?void 0x0:_0x5c0e1e[a6_0x7e59('0x14')])?(0x0,metric_logger_1[a6_0x7e59('0x22')])(_0x331b4f[a6_0x7e59('0x18')][a6_0x7e59('0x14')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);output['error']({'title':_0x331b4f[a6_0x7e59('0x7')]});process[a6_0x7e59('0x0')](0x1);}});}[a6_0x7e59('0x1a')](_0x4a6a79,_0x165be0){var _0x48a236;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1e1aae=(0x0,metric_logger_1[a6_0x7e59('0x1b')])('completeRunGroup');try{const _0x4cd675=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a6_0x7e59('0x25')][a6_0x7e59('0x4')]('/nx-cloud/executions/complete-run-group',{'runGroup':_0x4a6a79,'criticalErrorMessage':_0x165be0}),0x3);_0x1e1aae[a6_0x7e59('0x1e')]((0x0,metric_logger_1[a6_0x7e59('0x22')])(_0x4cd675));}catch(_0x25b786){_0x1e1aae[a6_0x7e59('0x1e')](((_0x48a236=_0x25b786===null||_0x25b786===void 0x0?void 0x0:_0x25b786[a6_0x7e59('0x18')])===null||_0x48a236===void 0x0?void 0x0:_0x48a236[a6_0x7e59('0x14')])?(0x0,metric_logger_1[a6_0x7e59('0x22')])(_0x25b786[a6_0x7e59('0x18')]['response']):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);}});}}exports[a6_0x7e59('0xd')]=DistributedExecutionApi;function createStartRequest(_0x116867,_0x471372,_0x3d89ca){const _0x5d8277=_0x471372[a6_0x7e59('0x30')](_0x2a3ba0=>{return _0x2a3ba0[a6_0x7e59('0x30')](_0x4f6db9=>{return{'taskId':_0x4f6db9['id'],'hash':_0x4f6db9[a6_0x7e59('0x2f')],'projectName':_0x4f6db9[a6_0x7e59('0x8')]['project'],'target':_0x4f6db9['target'][a6_0x7e59('0x8')],'configuration':_0x4f6db9['target'][a6_0x7e59('0x19')]||null,'params':(0x0,serializer_overrides_1[a6_0x7e59('0xb')])(_0x4f6db9)};});});const _0x24bcad={'command':(0x0,environment_1[a6_0x7e59('0x1d')])(),'branch':(0x0,environment_1['getBranch'])(),'runGroup':_0x116867,'tasks':_0x5d8277,'maxParallel':calculateMaxParallel(_0x3d89ca)};if(environment_1[a6_0x7e59('0xf')]){_0x24bcad['agentCount']=environment_1[a6_0x7e59('0xf')];}if(!environment_1[a6_0x7e59('0x1c')]){_0x24bcad[a6_0x7e59('0x1f')]=![];}return _0x24bcad;}exports[a6_0x7e59('0x10')]=createStartRequest;function calculateMaxParallel(_0x50954b){if(_0x50954b['parallel']===a6_0x7e59('0x13')||_0x50954b['parallel']===![]){return 0x1;}else if(_0x50954b[a6_0x7e59('0x3')]===a6_0x7e59('0x23')||_0x50954b[a6_0x7e59('0x3')]===!![]){return Number(_0x50954b[a6_0x7e59('0x21')]||0x3);}else if(_0x50954b['parallel']===undefined){return _0x50954b[a6_0x7e59('0x21')]?Number(_0x50954b[a6_0x7e59('0x21')]):0x3;}else{return Number(_0x50954b[a6_0x7e59('0x3')])||0x3;}}